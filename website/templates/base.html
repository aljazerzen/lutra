<!DOCTYPE html>
<html>

<head>
    {% include "partials/head.html" %}
</head>

<body>
    <div class="container">
        <header class="content">
            {% include "partials/header.html" %}
        </header>
    </div>

    {% if page %}
    {% set self = page %}
    {% else %}
    {% set self = section %}
    {% endif %}

    {% if (self.ancestors | length > 1) and false %}
    <div class="container">
        <nav class="content breadcrumbs">
            {% for ancestor in self.ancestors | slice(start=1) %}
            {% set section = get_section(path=ancestor, metadata_only=true) %}
            <a href="{{ section.permalink | safe }}">{{ section.title }}</a>
            {% endfor %}
        </nav>
    </div>
    {% endif %}

    <div class="container">

        <div class="sidebar-start">
            {% if self and self.ancestors[1] %}
            {% set index = get_section(path=self.ancestors[1]) %}
            {% endif %}
            {% if self and (self.ancestors | length == 1) %}
            {% set index = self %}
            {% endif %}

            {% if index %}
            <ul class="navigation">
                <li class="header {% if current_path==index.path %} active{% endif %}">
                    <a href="{{ index.permalink | safe }}">
                        {{ index.title }}
                    </a>
                </li>

                {% for s in index.subsections %}
                {% set subsection = get_section(path=s) %}

                {# Determine if this is the current subsection or if a page within it is active #}
                {% set is_active = false %}

                {% if current_path == subsection.path %}
                {% set is_active = true %}
                {% endif %}

                <li class="header {% if is_active %} active{% endif %}">
                    <a href="{{ subsection.permalink | safe }}">
                        {{ subsection.title }}
                    </a>
                </li>

                {# Show pages if book_only_current_section_pages is false OR if this is the current subsection #}
                {% if subsection.pages and (not config.extra.book_only_current_section_pages or current_path ==
                subsection.path or subsection.pages | filter(attribute="path", value=current_path) | length > 0) %}
                {% for page in subsection.pages %}
                <li {% if current_path==page.path %}class="active" {% endif %}>
                    <a href="{{ page.permalink | safe }}">
                        {{ page.title }}
                    </a>
                </li>
                {% endfor %}
                {% endif %}

                {% endfor %}
            </ul>
            {% endif %}
        </div>

        <div class="content">
            <details>
                <summary>⚠️ Work in progress</summary>
                This website (and Lutra project as a whole) is a work in progress.
                It describes what we want Lutra to become, not what it is yet.
                The content might be outdated, incomplete or might contain typos.
            </details>

            {% block main_content %}
            Nothing here?!
            {% endblock main_content %}
        </div>


        <div class="sidebar-end">
            {% if self.toc %}
            <ul class="toc">
                <li class="muted">On this page</li>
                {% for h1 in self.toc %}
                <li><a href="{{ h1.permalink | safe }}">{{ h1.title }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
    </div>

    <div class="container">
        <footer class="content">
            {% include "partials/footer.html" %}
        </footer>
    </div>
</body>

</html>
